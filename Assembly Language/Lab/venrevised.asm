.ORIG x3000
	LDI R1, X
	ADD R1, R1, #-2
	BRp XJANXFEB
	ADD R1, R1, #12
	LDI R0, C
	ADD R0, R0, #-1
	STI R0, C

XJANXFEB
	STI R1, M
	AND R0, R0, x0
	ADD R0, R0, #13

	JSR MULTIPLY
	ADD R2, R2, #-1
	STI R2, REVISEDMONTH
	ADD R0, R2, x0
	AND R1, R1, x0
	ADD R1, R1, x5

	JSR DIVIDE
	STI R2, MONQUOTIENT
	LDI R0, C
	AND R1, R1, x0
	ADD R1, R1, xF
	ADD R1, R1, xF
	ADD R1, R1, xF
	ADD R1, R1, xF
	ADD R1, R1, xF
	ADD R1, R1, xF
	ADD R1, R1, xA

	JSR DIVIDE
	STI R0, D
	STI R2, REVISEDCENT
	LDI R0, D
	AND R1, R1, x0
	ADD R1, R1, x4

	JSR DIVIDE
	STI R2, LASTNUMQUOTIENT
	LDI R0, REVISEDCENT
	AND R1, R1, x0
	ADD R1, R1, x4

	JSR DIVIDE	 
	STI R2, CENTQUOTIENT

	JSR ZELEQ
	STI R0, F
	AND R1, R1, x0
	ADD R1, R1, x7

	JSR DIVIDE
	STI R0, FMODULO
	ADD R1, R0, x0
	LEA R0, DAYS

	LOOP
	ADD R1, R1, #-1
	BRn DISPLAY
	ADD R0, R0, xA
	BR LOOP
	DISPLAY PUTS
	HALT

MULTIPLY
	BRnz END
	AND R2, R2, x0
	
MULTIPLYLOOP
	ADD R2, R2, R0
	ADD R1, R1, #-1
	BRp MULTIPLYLOOP
	BRn END
	RET

DIVIDE
	BRn END
	NOT R1, R1
	ADD R1, R1, x1
	AND R2, R2, x0

DIVIDELOOP
	ADD R0, R0, R1
	BRn QUOTEND1
	ADD R2, R2, x1
	BR DIVIDELOOP

QUOTEND2
	ADD R2, R2, x1
	ADD R0,R0, R1

QUOTEND1
	NOT R1, R1
	ADD R1, R1, x1
	ADD R0, R0, R1
	RET

ZELEQ
	LDI R0, K
	LDI R1,  MONQUOTIENT
	ADD R0, R0, R1
	LDI R1, D
	ADD R0, R0, R1
	LDI R1, LASTNUMQUOTIENT
	ADD R0, R0, R1
	LDI R1, CENTQUOTIENT
	ADD R0, R0, R1
	LDI R1, REVISEDCENT
	ADD R1, R1, R1
	NOT R1, R1
	ADD R1, R1, x1
	ADD R0, R0, R1
	RET
END HALT

DAYS    .STRINGZ "Sunday   "
	.STRINGZ "Monday   "
	.STRINGZ "Tuesday  "
	.STRINGZ "Wednesday"
	.STRINGZ "Thursday "
	.STRINGZ "Friday   "
	.STRINGZ "Saturday "

X	.FILL X3200
K	.FILL X3201
C	.FILL X3202
FMODULO .FILL X3203
R	.FILL X3204
M	.FILL X3205
REVISEDMONTH	.FILL X31F6
MONQUOTIENT	.FILL X3103
LASTNUMQUOTIENT	.FILL X3104
CENTQUOTIENT	.FILL X3105
F	.FILL X3106
D	.FILL X3017
REVISEDCENT	.FILL X3018
	.END
