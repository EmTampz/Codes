;Subroutines: Multiplication, Division, Modulo
.ORIG	x3000
	LDI R1, X
	LDI R2, Y
	JSR PRDCT
	STI R3, XY
	JSR DVSN
	STI R5, QTNT
	STI R3, MDL
	HALT

PRDCT
	ST R5, Rgstr5
	ST R6, Rgstr6

	ADD R4, R2, #0
	NOT R4, R4
	ADD R4, R4, #1
	BRp PSTVLOOP

LOOP	ADD R6, R5, R4
	BRzp QT1
	ADD R5, R5, #1
	ADD R3, R3, R1
	BR LOOP
QT1	RET


PSTVLOOP ADD R4, R4, #0
LOOP2 	ADD R6, R5, R4
	BRz QT2
	ADD R5, R5, #1
	ADD R3, R3, R1
	BR LOOP2
QT2 	NOT R3, R3
	ADD R3, R3 #1

	LD R5, Rgstr5
	LD R6, Rgstr6
	RET
Rgstr5 .FILL X0
Rgstr6 .FILL X0

DVSN
	ADD R2, R2, #0
	BRz QT3
	ADD R6, R2, #0
	AND R5, R5, #0
	ADD R3, R1, #0
	ADD R4, R2, #0
	NOT R4, R4
	ADD R4, R4, #1
	ADD R0, R3, R4
	BRn QT2
LOOP3	ADD R5, R5, #1
	ADD R3, R3, R4
	BRp LOOP3
	BRz QT3
	ADD R3, R3, R6
	ADD R5, R5, #-1
	BR QT3
QT3	RET

X	.FILL X3100
Y	.FILL X3101
XY	.FILL X3102
QTNT	.FILL X3103
MDL	.FILL X3104
.END